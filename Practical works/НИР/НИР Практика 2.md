---
tags:
  - типовой-рассчет
  - 2nd-semester
  - 20-03-2024
  - нир
---

## НИР Практика 2

### Ершов Алексей Геннадьевич КМБО-03-23

### Вариант 4

```r
# ЧАСТЬ 2.1

# swiss : Education ~ Fertility + Agriculture + Infant.Mortality

library("lmtest")

data = swiss

# Прослеживается низкая зависимость (R^2 = 0.12), оставим регрессор
summary(lm(Fertility~Agriculture, data))
# Прослеживается низкая зависимость (R^2 = 0.17), оставим регрессор
summary(lm(Fertility~Infant.Mortality, data))
# Прослеживается очень низкая зависимость (R^2 = 0.003), оставим регрессор
summary(lm(Agriculture~Infant.Mortality, data))

# Все проверенные регрессоры не имеют взаимной значимой линейной зависимости

# Полученная сырая модель имеет R^2 = 0.63, что говорит о том, что зависимость 
# определенно прослеживается, но она не очень сильна. В то же время регрессоры
# Fertility и Agriculture имеют оценку в "***", что говорит о сильной статистической 
# связанности этих регрессоров и объясняемой переменной. Регрессор Infant.Mortality
# же имеет ноль "*", => им можно пренебречь.
summary(lm(Education ~ Fertility + Agriculture + Infant.Mortality, data))

# Введем логарифмы регрессоров

# Модель лучше изначальной: R^2 = 0,7
summary(lm(Education ~ log(Fertility) + Agriculture + Infant.Mortality, data))
# Модель еще лучше изначальной: R^2 = 0,756
summary(lm(Education ~ log(Fertility) + log(Agriculture) + Infant.Mortality, data))
# Модель стала чуть хуже: R^2 = 0,755
summary(lm(Education ~ log(Fertility) + log(Agriculture) + log(Infant.Mortality), data))

# Наилучшей вышла вторая модель
summary(lm(Education ~ log(Fertility) + log(Agriculture) + Infant.Mortality, data))

# Введем произведения и квараты регрессоров

# R^2 = 0.798 - круто
summary(lm(Education ~ log(Fertility) + log(Agriculture) + Infant.Mortality + I(Fertility^2), data))
# R^2 = 0.747 - не круто
summary(lm(Education ~ log(Fertility) + log(Agriculture) + Infant.Mortality + I(Agriculture^2), data))
# R^2 = 0.747 - тоже не круто
summary(lm(Education ~ log(Fertility) + log(Agriculture) + Infant.Mortality + I(Infant.Mortality^2), data))

# R^2 = 0.751 - не очень круто
summary(lm(Education ~ log(Fertility) + log(Agriculture) + Infant.Mortality + I(Fertility*Agriculture), data))
# R^2 = 0.775 - покруче, но недотягивает до первого вар.
summary(lm(Education ~ log(Fertility) + log(Agriculture) + Infant.Mortality + I(Fertility*Infant.Mortality), data))
# R^2 = 0.747 - тоже не круто
summary(lm(Education ~ log(Fertility) + log(Agriculture) + Infant.Mortality + I(Agriculture*Infant.Mortality), data))

# Наилучшей вышла вторая модель (R^2 = 0.798)
summary(lm(Education ~ log(Fertility) + log(Agriculture) + Infant.Mortality + I(Fertility^2), data))
best_model = lm(Education ~ log(Fertility) + log(Agriculture) + Infant.Mortality + I(Fertility^2), data)

# Рассмотрим индивидуальные лин. регрессии, построенные на основе каждого из регрессоров

# Регрессор log(Fertility) - значим; взаимосвязь между объясняемой и объясняющей переменной - отрицательная (k = -35)
summary(lm(Education ~ log(Fertility), data))
# Регрессор log(Agriculture) - значим; взаимосвязь между объясняемой и объясняющей переменной - отрицательная (k = -9.4)
summary(lm(Education ~ log(Agriculture), data))
# Регрессор Infant.Mortality - не значим
summary(lm(Education ~ Infant.Mortality, data))
# Регрессор I(Fertility^2) - значим; взаимосвязь между объясняемой и объясняющей переменной - отрицательная (k = -0.003)
summary(lm(Education ~ I(Fertility^2), data))

# ЧАСТЬ 2.2

# Std. err:
#   log(Fertility) : 14.023
#   log(Agriculture) : 1.117
#   Infant.Mortality : 0.256
#   I(Fertility^2) : 0.002
summary(best_model)

# t_criterion = 1.682 (p = 95%, 42 степени свободы)
t_crit = qt(0.95, df=42)
t_crit

# Доверительные интервалы для соотв. регрессоров:

# log(Fertility)
c(-69.795 - t_crit*14.023, -69.795 + t_crit*14.023)
# log(Agriculture)
c(-4.712 - t_crit*1.117, -4.712 + t_crit*1.117)
# Infant.Mortality
c(0.443 - t_crit*0.256, 0.443 + t_crit*0.256)
# I(Fertility^2)
c(0.005 - t_crit*0.0015, 0.005 + t_crit*0.0015)

# Ни в один из интервалов не попадает "0" => гипотеза о равенстве
# коэффициента нулю опровергнута

# Доверительный интервал для одного прогноза:
# Fertility = 80, Agriculture = 25, Infant.Mortality = 15
best_model = lm(Education ~ log(Fertility) + log(Agriculture) + Infant.Mortality + I(Fertility^2), data)
new.data = data.frame(Fertility = 80, Agriculture = 25, Infant.Mortality = 15)
predict(best_model, new.data, interval="confidence")

# Единственный x - не функция - это регрессор Infant.Mortality
# Построим модель для него модель и найдем в ней доверительный интервал его коэфф.

summary(lm(Education~Infant.Mortality, data))
# t_criterion = 1.679 (p = 95%, 45 степеней свободы)
t_crit2 = qt(0.95, df=45)
t_crit2

# В полученный доверительный интервал попал 0, а => выявленная связь между
# Education и Infant.Mortality - отсутствует
c(-0.328 - t_crit2*0.49, -0.328 + t_crit2*0.49)
```
