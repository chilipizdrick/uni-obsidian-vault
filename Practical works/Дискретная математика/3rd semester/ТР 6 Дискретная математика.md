---
tags:
  - типовой-расчет
  - 2nd-semester
  - 2024-11-20
---

### Ершов Алексей Геннадьевич КМБО-03-23

### Вариант 5

$$\begin{pmatrix}
2 & 2 & 3 & 4 & 4 & 5 \\
2 & 2 & 3 & 4 & 5 & 6 \\
2 & 4 & 4 & 4 & 4 & 5 \\
0 & 1 & 3 & 5 & 7 & 7 \\
1 & 2 & 3 & 3 & 4 & 5 \\
2 & 3 & 4 & 4 & 6 & 7
\end{pmatrix}$$

### 1-ая итерация

$$\begin{gather}
\begin{array}{c|ccccc|c|c}
& r_{1} & r_{2} & r_{3} & r_{4} & r_{5} & r_{6} \\
\hline l_{1} & 2 & 2 & 3 & 4 & 4 & 5 & 5 \\
l_{2} & 2 & 2 & 3 & 4 & 5 & 6 & 6 \\
l_{3} & 2 & 4 & 4 & 4 & 4 & 5 & 5 \\
l_{4} & 0 & 1 & 3 & 5 & 7 & 7 & 7 \\
l_{5} & 1 & 2 & 3 & 3 & 4 & 5 & 5 \\
l_{6} & 2 & 3 & 4 & 4 & 6 & \underline{7} & 7 \\
& \hline 0 & 0 & 0 & 0 & 0 & 0
\end{array}
\end{gather}$$

![[ТР 6 Дискретная математика 2024-11-20 13.58.02.excalidraw|300]]

### 2-ая итерация

$$\begin{gather}
\begin{array}{c|cccc|cc|c}
& r_{1} & r_{2} & r_{3} & r_{4} & r_{5} & r_{6} \\
\hline l_{1} & 2 & 2 & 3 & 4 & 4 & 5 & 5 \\
l_{2} & 2 & 2 & 3 & 4 & 5 & 6 & 6 \\
l_{3} & 2 & 4 & 4 & 4 & 4 & 5 & 5 \\
l_{4} & 0 & 1 & 3 & 5 & \underline 7 & 7 & 7 \\
l_{5} & 1 & 2 & 3 & 3 & 4 & 5 & 5 \\
l_{6} & 2 & 3 & 4 & 4 & 6 & \underline{7} & 7 \\
& \hline 0 & 0 & 0 & 0 & 0 & 0
\end{array}
\end{gather}$$

![[ТР 6 Дискретная математика 2024-11-22 13.03.57.excalidraw|300]]

### 3-ая итерация

$$\begin{gather}
\begin{array}{c|ccc|ccc|c}
& r_{1} & r_{2} & r_{3} & r_{4} & r_{5} & r_{6} \\
\hline l_{1} & 2 & 2 & 3 & 4 & 4 & 5 & 5 \\
l_{2} & 2 & 2 & 3 & 4 & 5 & 6 & 6 \\
l_{3} & 2 & 4 & 4 & 4 & 4 & 5 & 5 \\
l_{4} & 0 & 1 & 3 & 5 & \underline 7 & 7 & 7 \\
l_{5} & 1 & 2 & 3 & 3 & 4 & 5 & 5 \\
l_{6} & 2 & 3 & 4 & 4 & 6 & \underline{7} & 7 \\
& \hline 0 & 0 & 0 & 0 & 0 & 0
\end{array}
\end{gather}$$

Так как теперь в матрице нету ребер в добавленном столбце таких, что $l(x) + l(y) = a(x,y)$, необходимо перерасчитать потенциалы, согласно найденным в процессе обхода графа множествам $S$ и $T$.

![[ТР 6 Дискретная математика 2024-11-22 13.06.43.excalidraw|300]]

$$\begin{gather}
S = \{ l_{1}, l_{2}, l_{3}, l_{5}, l_{6} \} \\
T = \{ r_{6} \} \\
\delta = 1
\end{gather}$$

$$\begin{gather}
l(x) -= \delta \\
l(y) += \delta
\end{gather}$$

$$\begin{gather}
\begin{array}{c|ccc|ccc|c}
& r_{1} & r_{2} & r_{3} & r_{4} & r_{5} & r_{6} \\
\hline l_{1} & 2 & 2 & 3 & \underline 4 & 4 & 5 & 4 \\
l_{2} & 2 & 2 & 3 & 4 & 5 & 6 & 5 \\
l_{3} & 2 & 4 & 4 & 4 & 4 & 5 & 4 \\
l_{4} & 0 & 1 & 3 & 5 & \underline 7 & 7 & 7 \\
l_{5} & 1 & 2 & 3 & 3 & 4 & 5 & 4 \\
l_{6} & 2 & 3 & 4 & 4 & 6 & \underline 7 & 6 \\
& \hline 0 & 0 & 0 & 0 & 0 & 1
\end{array}
\end{gather}$$

![[ТР 6 Дискретная математика 2024-11-22 13.24.55.excalidraw|300]]

### 4-ая итерация

$$\begin{gather}
\begin{array}{c|cc|cccc|c}
& r_{1} & r_{2} & r_{3} & r_{4} & r_{5} & r_{6} \\
\hline l_{1} & 2 & 2 & 3 & \underline 4 & 4 & 5 & 4 \\
l_{2} & 2 & 2 & 3 & 4 & 5 & 6 & 5 \\
l_{3} & 2 & 4 & \underline 4 & 4 & 4 & 5 & 4 \\
l_{4} & 0 & 1 & 3 & 5 & \underline 7 & 7 & 7 \\
l_{5} & 1 & 2 & 3 & 3 & 4 & 5 & 4 \\
l_{6} & 2 & 3 & 4 & 4 & 6 & \underline 7 & 6 \\
& \hline 0 & 0 & 0 & 0 & 0 & 1
\end{array}
\end{gather}$$

![[ТР 6 Дискретная математика 2024-11-23 12.49.56.excalidraw|300]]

### 5-ая итерация

$$\begin{gather}
\begin{array}{c|c|ccccc|c}
& r_{1} & r_{2} & r_{3} & r_{4} & r_{5} & r_{6} \\
\hline l_{1} & 2 & 2 & 3 & \underline 4 & 4 & 5 & 4 \\
l_{2} & 2 & 2 & 3 & 4 & 5 & 6 & 5 \\
l_{3} & 2 & 4 & \underline 4 & 4 & 4 & 5 & 4 \\
l_{4} & 0 & 1 & 3 & 5 & \underline 7 & 7 & 7 \\
l_{5} & 1 & 2 & 3 & 3 & 4 & 5 & 4 \\
l_{6} & 2 & 3 & 4 & 4 & 6 & \underline 7 & 6 \\
& \hline 0 & 0 & 0 & 0 & 0 & 1
\end{array}
\end{gather}$$

Так как теперь в матрице нету ребер в добавленном столбце таких, что $l(x) + l(y) = a(x,y)$, необходимо перерасчитать потенциалы, согласно найденным в процессе обхода графа множествам $S$ и $T$.

![[ТР 6 Дискретная математика 2024-11-24 23.24.41.excalidraw]]

![[ТР 6 Дискретная математика 2024-11-22 13.06.43.excalidraw|300]]

$$\begin{gather}
S = \{ l_{2}, l_{4}, l_{5}, l_{6} \} \\
T = \{ r_{5}, r_{6} \} \\
\delta = 1
\end{gather}$$

$$\begin{gather}
\begin{array}{c|c|ccccc|c}
& r_{1} & r_{2} & r_{3} & r_{4} & r_{5} & r_{6} \\
\hline l_{1} & 2 & 2 & 3 & \underline 4 & 4 & 5 & 4 \\
l_{2} & 2 & 2 & 3 & 4 & 5 & 6 & 4 \\
l_{3} & 2 & 4 & \underline 4 & 4 & 4 & 5 & 4 \\
l_{4} & 0 & 1 & 3 & 5 & \underline 7 & 7 & 6 \\
l_{5} & 1 & 2 & 3 & 3 & 4 & 5 & 3 \\
l_{6} & 2 & 3 & 4 & 4 & 6 & \underline 7 & 5 \\
& \hline 0 & 0 & 0 & 0 & 1 & 2
\end{array}
\end{gather}$$

![[ТР 6 Дискретная математика 2024-11-23 13.03.27.excalidraw|300]]

В полученном графе есть увеличивающая цепь $l_{5}-r_{3}-l_{3}-r_{2}$.

$$\begin{gather}
\begin{array}{c|c|ccccc|c}
& r_{1} & r_{2} & r_{3} & r_{4} & r_{5} & r_{6} \\
\hline l_{1} & 2 & 2 & 3 & \underline 4 & 4 & 5 & 4 \\
l_{2} & 2 & 2 & 3 & 4 & 5 & 6 & 4 \\
l_{3} & 2 & \underline 4 & 4 & 4 & 4 & 5 & 4 \\
l_{4} & 0 & 1 & 3 & 5 & \underline 7 & 7 & 6 \\
l_{5} & 1 & 2 & \underline 3 & 3 & 4 & 5 & 3 \\
l_{6} & 2 & 3 & 4 & 4 & 6 & \underline 7 & 5 \\
& \hline 0 & 0 & 0 & 0 & 1 & 2
\end{array}
\end{gather}$$

![[ТР 6 Дискретная математика 2024-11-23 13.08.27.excalidraw|300]]

### 5-ая итерация

$$\begin{gather}
\begin{array}{c|cccccc|c}
& r_{1} & r_{2} & r_{3} & r_{4} & r_{5} & r_{6} \\
\hline l_{1} & 2 & 2 & 3 & \underline 4 & 4 & 5 & 4 \\
l_{2} & 2 & 2 & 3 & 4 & 5 & 6 & 4 \\
l_{3} & 2 & \underline 4 & 4 & 4 & 4 & 5 & 4 \\
l_{4} & 0 & 1 & 3 & 5 & \underline 7 & 7 & 6 \\
l_{5} & 1 & 2 & \underline 3 & 3 & 4 & 5 & 3 \\
l_{6} & 2 & 3 & 4 & 4 & 6 & \underline 7 & 5 \\
& \hline 0 & 0 & 0 & 0 & 1 & 2
\end{array}
\end{gather}$$

Так как теперь в матрице нету ребер в добавленном столбце таких, что $l(x) + l(y) = a(x,y)$, необходимо перерасчитать потенциалы, согласно найденным в процессе обхода графа множествам $S$ и $T$.

![[ТР 6 Дискретная математика 2024-11-23 13.13.17.excalidraw|300]]

$$\begin{gather}
S = \{ l_{1}, l_{2}, l_{4}, l_{6} \} \\
T = \{ r_{4}, r_{5}, r_{6} \} \\
\delta = 1
\end{gather}$$

$$\begin{gather}
\begin{array}{c|cccccc|c}
& r_{1} & r_{2} & r_{3} & r_{4} & r_{5} & r_{6} \\
\hline l_{1} & 2 & 2 & 3 & \underline 4 & 4 & 5 & 3 \\
l_{2} & 2 & 2 & 3 & 4 & 5 & 6 & 3 \\
l_{3} & 2 & \underline 4 & 4 & 4 & 4 & 5 & 4 \\
l_{4} & 0 & 1 & 3 & 5 & \underline 7 & 7 & 5 \\
l_{5} & 1 & 2 & \underline 3 & 3 & 4 & 5 & 3 \\
l_{6} & 2 & 3 & 4 & 4 & 6 & \underline 7 & 4 \\
& \hline 0 & 0 & 0 & 1 & 2 & 3
\end{array}
\end{gather}$$

![[ТР 6 Дискретная математика 2024-11-23 13.30.40.excalidraw|300]]

Все еще в матрице нету ребер в добавленном столбце таких, что $l(x) + l(y) = a(x,y)$, необходимо перерасчитать потенциалы, согласно найденным в процессе обхода графа множествам $S$ и $T$.

![[ТР 6 Дискретная математика 2024-11-23 13.33.01.excalidraw|300]]

$$\begin{gather}
S = \{ l_{1}, l_{2}, l_{4}, l_{5}, l_{6} \} \\
T = \{ r_{3}, r_{4}, r_{5}, r_{6} \} \\
\delta = 1
\end{gather}$$

$$\begin{gather}
\begin{array}{c|cccccc|c}
& r_{1} & r_{2} & r_{3} & r_{4} & r_{5} & r_{6} \\
\hline l_{1} & 2 & 2 & 3 & \underline 4 & 4 & 5 & 2 \\
l_{2} & 2 & 2 & 3 & 4 & 5 & 6 & 2 \\
l_{3} & 2 & \underline 4 & 4 & 4 & 4 & 5 & 4 \\
l_{4} & 0 & 1 & 3 & 5 & \underline 7 & 7 & 4 \\
l_{5} & 1 & 2 & \underline 3 & 3 & 4 & 5 & 2 \\
l_{6} & 2 & 3 & 4 & 4 & 6 & \underline 7 & 3 \\
& \hline 0 & 0 & 1 & 2 & 3 & 4
\end{array}
\end{gather}$$

![[ТР 6 Дискретная математика 2024-11-23 13.38.14.excalidraw|300]]

В полученном графе есть увеличивающая цепь $l_{2}-r_{4}-l_{1}-r_{1}$.

$$\begin{gather}
\begin{array}{c|cccccc|c}
& r_{1} & r_{2} & r_{3} & r_{4} & r_{5} & r_{6} \\
\hline l_{1} & \underline 2 & 2 & 3 & 4 & 4 & 5 & 2 \\
l_{2} & 2 & 2 & 3 & \underline 4 & 5 & 6 & 2 \\
l_{3} & 2 & \underline 4 & 4 & 4 & 4 & 5 & 4 \\
l_{4} & 0 & 1 & 3 & 5 & \underline 7 & 7 & 4 \\
l_{5} & 1 & 2 & \underline 3 & 3 & 4 & 5 & 2 \\
l_{6} & 2 & 3 & 4 & 4 & 6 & \underline 7 & 3 \\
& \hline 0 & 0 & 1 & 2 & 3 & 4
\end{array}
\end{gather}$$

![[ТР 6 Дискретная математика 2024-11-23 13.41.10.excalidraw|300]]

Полученно совершенное  паросочетание, найденное максимальное назначение - $|M| = 7+7+4+3+4+2 = 27$. 

Наденное назначение действиетельно максимально, т.к. результат работы Венгерского алгоритма - всегда является максимальным (минимальным) паросочетанием в силу того, как изменяется "потенциал" для поиска новых входящих в паросочетание ребер (всегда рассматривается минимальный прирост, что позволяет находить максимальное назначение на каждом этапе алгоритма).

### (Проверка методом редукции матрицы алгоритмом за $O(n^{5})$)

Так как задача стоит в поиске максимального назначения, необходимо вычесть из каждой стоки матрицы максимальный элемент и домножить на -1 полученную матрицу.

$$\begin{gather}
\begin{array}{|c|c|}
\hline 2 & 2 & 3 & 4 & 4 & 5 \\
\hline 2 & 2 & 3 & 4 & 5 & 6 \\
\hline 2 & 4 & 4 & 4 & 4 & 5 \\
\hline 0 & 1 & 3 & 5 & 7 & 7 \\
\hline 1 & 2 & 3 & 3 & 4 & 5 \\
\hline 2 & 3 & 4 & 4 & 6 & 7 \\
\hline
\end{array} \to
\begin{array}{|c|c|}
\hline -3 & -3 & -2 & -1 & -1 & 0 \\
\hline -4 & -4 & -3 & -2 & -1 & 0 \\
\hline -3 & -1 & -1 & -1 & -1 & 0 \\
\hline -7 & -6 & -4 & -2 & 0 & 0 \\
\hline -4 & -3 & -2 & -2 & -1 & 0 \\
\hline -5 & -4 & -3 & -3 & -1 & 0 \\
\hline
\end{array} \to \\
\to \begin{array}{|c|c|}
\hline 3 & 3 & 2 & 1 & 1 & 0 \\
\hline 4 & 4 & 3 & 2 & 1 & 0 \\
\hline 3 & 1 & 1 & 1 & 1 & 0 \\
\hline 7 & 6 & 4 & 2 & 0 & 0 \\
\hline 4 & 3 & 2 & 2 & 1 & 0 \\
\hline 5 & 4 & 3 & 3 & 1 & 0 \\
\hline
\end{array}\\
\end{gather}$$

Выбрать в каждом столбце и строке $0$ - не выходит, продолжаем ход алгоритма.

Редукция по строкам (вычитаем минимальный элемент из каждой строки):

$$\begin{array}{|c|c|}
\hline 3 & 3 & 2 & 1 & 1 & 0 \\
\hline 4 & 4 & 3 & 2 & 1 & 0 \\
\hline 3 & 1 & 1 & 1 & 1 & 0 \\
\hline 7 & 6 & 4 & 2 & 0 & 0 \\
\hline 4 & 3 & 2 & 2 & 1 & 0 \\
\hline 5 & 4 & 3 & 3 & 1 & 0 \\
\hline
\end{array}$$

Редукция по столбцам (вычитаем минимальный элемент из каждого столбца):

$$\begin{array}{|c|c|}
\hline 3 & 3 & 2 & 1 & 1 & 0 \\
\hline 4 & 4 & 3 & 2 & 1 & 0 \\
\hline 3 & 1 & 1 & 1 & 1 & 0 \\
\hline 7 & 6 & 4 & 2 & 0 & 0 \\
\hline 4 & 3 & 2 & 2 & 1 & 0 \\
\hline 5 & 4 & 3 & 3 & 1 & 0 \\
\hline
\end{array} \to \begin{array}{|c|c|}
\hline 0 & 2 & 1 & 0 & 0 & 0 \\
\hline 1 & 3 & 2 & 1 & 0 & 0 \\
\hline 0 & 0 & 0 & 0 & 0 & 0 \\
\hline 4 & 5 & 3 & 1 & 0 & 0 \\
\hline 1 & 2 & 1 & 1 & 0 & 0 \\
\hline 2 & 3 & 2 & 2 & 0 & 0 \\
\hline
\end{array}$$

Выбрать в каждом столбце и строке $0$ - не выходит, продолжаем ход алгоритма.

Вычеркиваем минимальное количество строк и столбцов, содержащих нулевые элементы.

$$\begin{array}{|c|c|}
\hline \not0 & \not2 & \not1 & \not0 & \not0 & \not0 \\
\hline 1 & 3 & 2 & 1 & \not0 & \not0 \\
\hline \not0 & \not0 & \not0 & \not0 & \not0 & \not0 \\
\hline 4 & 5 & 3 & 1 & \not0 & \not0 \\
\hline 1 & 2 & 1 & 1 & \not0 & \not0 \\
\hline 2 & 3 & 2 & 2 & \not0 & \not0 \\
\hline
\end{array}$$

Cреди оставшихся элементов ищем минимальный, вычитаем его из незачеркнутых элементов и прибавляем к элементам, находящимся на пересечении вычеркнутых строк:


$$\begin{array}{|c|c|}
\hline 0 & 2 & 1 & 0 & 1 & 1 \\
\hline 0 & 2 & 1 & 0 & 0 & 0 \\
\hline 0 & 0 & 0 & 0 & 1 & 1 \\
\hline 3 & 4 & 2 & 0 & 0 & 0 \\
\hline 0 & 1 & 0 & 0 & 0 & 0 \\
\hline 1 & 2 & 1 & 1 & 0 & 0 \\
\hline
\end{array}$$

Выбрать в каждом столбце и строке $0$ - выходит, тогда найденное максимальное назначение - сумма элементов матрицы, находящиеся на местах найденных нулей в изначальной матрице.

$$\begin{array}{|c|c|}
\hline \underline 0 & 2 & 1 & 0 & 1 & 1 \\
\hline 0 & 2 & 1 & \underline 0 & 0 & 0 \\
\hline 0 & \underline 0 & 0 & 0 & 1 & 1 \\
\hline 3 & 4 & 2 & 0 & \underline 0 & 0 \\
\hline 0 & 1 & \underline0 & 0 & 0 & 0 \\
\hline 1 & 2 & 1 & 1 & 0 & \underline 0 \\
\hline
\end{array} \implies \begin{array}{|c|c|}
\hline \underline 2 & 2 & 3 & 4 & 4 & 5 \\
\hline 2 & 2 & 3 & \underline 4 & 5 & 6 \\
\hline 2 & \underline 4 & 4 & 4 & 4 & 5 \\
\hline 0 & 1 & 3 & 5 & \underline 7 & 7 \\
\hline 1 & 2 & \underline 3 & 3 & 4 & 5 \\
\hline 2 & 3 & 4 & 4 & 6 & \underline 7 \\
\hline
\end{array}$$

$|M| = 2+4+3+4+7+7 = 27$.

