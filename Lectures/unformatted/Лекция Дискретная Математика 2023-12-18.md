## Освежим [[Лекция Дискретная Математика 2023-12-11|прошлую лекцию]]

На прошлых занятиях мы работали с остатками ([[Кольца]])
$\mathbb{Z}_{n}=\{ \bar{0}, \bar{1}, \dots, \bar{n-1} \}$

Кольцо можно определить декартовым произведением

$A\times B=\{ (a,b) ~ ~a\in A; b \in B \}$

Также говорили об [[Изоморфизм|Изоморфизме]]
(изоморфизм групп это такая биекция групп, согласованная по операцию умножения...)

### Изоморфизм 
$f:X\to Y$  -кольца
$I \text{ биекция}$
$II \text{ согл. с операциями}$
$f(x+x')=f(x)+f(x')$
$f(x\cdot x')=f(x)\cdot f(x')$

$f(0)=0$ 
$f(1)=1$


$X \cong Y$ $\text{ если } \exists \text{ изом. } f: X\to Y$

### Продолжение

$\mathbb{Z}_{m}\times \mathbb{Z}_{n}\cong \mathbb{Z}_{mn} \iff \text{НОД}(m,n)=1$ (m и n взаимнопросты)

нужно понимать, что роль единицы в декартовом произведении играет (1,1 )если мы возьмем порядок по сложению пары (1,1)$\in\mathbb{Z}_{m}\times \mathbb{Z}_{n}$ равен наименьшему кратному $\text{НОК}(m,n)$

$\underbrace{ (1,1)+\dots+(1,1) }_{ \text{k раз} }$=(k ($\text{mod m}$)), k $\text{(mod n)}$) = (0,0) $\iff$ $k \vdots m$; $k \vdots n$  в первый раз при $k = \text{НОК}(n,m)$
почему мы не пишем $\underbrace{ a+a+\dots+a }_{ k }=k\cdot a$ ? тк в кольцах неизвестно какие элементы

порядок $1\in\mathbb{Z}_{mn}$ в $\mathbb{Z}_{nm}$ равен $nm$


### Как строить изоморфизм

$f:\mathbb{Z}_{mn}\to \mathbb{Z}_{m}\times \mathbb{Z}_{n}$ ?

$k \in \mathbb{Z}_{mn}$
$f(1)=(1,1)$
$f(k)=$(k ($\text{mod m}$)), k $\text{(mod n)}$)
$f(k+k')=f(\bar{k})+f(\bar{k'})$
$f(k\cdot k')=f(\bar{k})\cdot f(\bar{k'})$
то, что это биекция - понятно


$\bar{k}+\bar{k}$ в $\mathbb{Z}_{mn}$ = остаток от дел. числа $k+k'$ на $mn$
$f(\bar{k})$ = (остаток от деления числа k на м, остаток от деления $k'$ на n
$f(k)+f(k')$
факт наличия этого изоморфизма называется слабой формой [[Китайская теорема об остатках|Китайской теорема об остатках]]

#### Пример

	$f:\mathbb{Z}_{30}\to \mathbb{Z}_{5}\times \mathbb{Z}_{6}$
	$\bar{13}\to (\bar{3}, \bar{1})$

## Как вычислять $f^{-1}$ для нашей биекции ([[Китайская теорема об остатках]])

Мы хотим вычислить $f^{-1}$ от $(\bar{a},\bar{b})$
$\bar{a} \in \mathbb{Z}_{m}$
$\bar{b} \in \mathbb{Z}_{n}$

$(\bar{a}, \bar{b})=(\bar{a}, \bar{0})+(\bar{0}, \bar{b})=\underbrace{ (\bar{1},\bar{0})+\dots+(\bar{1},\bar{0}) }_{ \text{a раз} }+\underbrace{ (\bar{0}, \bar{1})+\dots+(\bar{0}, \bar{1}) }_{ \text{b раз} }=a\cdot(\bar{1}, \bar{0})+b\cdot(\bar{0}, \bar{1})$

$f^{-1}(a\cdot(\bar{1}, \bar{0})+b(\bar{0}, \bar{1}))=f^{-1}(a(\bar{1}, \bar{0}))+f^{-1}(b(\bar{0}, \bar{1}))=\underbrace{ a\cdot f^{-1}(\bar{1}, \bar{0}) }_{ \in\mathbb{Z}_{mn} }+\underbrace{ b\cdot f^{-1}(\bar{0}, \bar{1}) }_{ \mathbb{Z}_{mn} }$
$\text{как найти}$ $f^{-1}(1,0)$ и $f^{-1}(0,1)$
$f^{-1}(\bar{1}, \bar{0})=x$ ? $\bar{x}\in\mathbb{Z}_{mn}$
$f(x)-(\bar{1}, \bar{0}) \iff$
$$
\begin{cases}
x\equiv1 \text{ mod m} \\
x\equiv0 \text{ mod n}
\end{cases}
$$
$$
\begin{cases}
x=1+mS \\
x=0+nt
\end{cases}s,t \in\mathbb{Z}
$$
$nt-ms=1$

имеет решения тогда и только тогда когда m и n - взаимнопростые
$(m,n)=1 \iff \exists \text{ решение } (s_{0}, t_{0})$
$x=n\cdot t_{0}$
$x=1+m\cdot s_{0}$
найти такую пару никакого труда не составляет
это и есть та самая инструкция чтобы решить общую систему, нужно найти два прообраза 

возвращаясь к "$f^{-1}(1,0)$ и $f^{-1}(0,1)$" - это основные [[Идемпотентный элемент|идемпотенты]]
$(1,0)^{2}=(1^{2}, 0^{2})=(1,0)$
$(0,1)^{2}=(0,1)$

x - [[Идемпотентный элемент]] в кольце $\mathbb{Z}_{mn}$

понятно, что если мы решаем 
$\bar{x}^{2}=\bar{x}$ в $\mathbb{Z}_{mn}$
$\bar{x}(\bar{1}-\bar{x})=0$ в $\mathbb{Z}_{mn}$
откуда берутся нули? если мы берем модуль не простой - один сомножитель содержит один из делителей, а другой оставшийся

$x\vdots n$
$1-x\vdots n$
получаем это же 
($x=n\cdot t_{0}$ , $x=1+m\cdot s_{0}$)

### Пример
$\mathbb{Z}_{30}\cong \mathbb{Z}_{5}\times \mathbb{Z}_{6}$
$m=5$      $n=6$

$(1,0)$  $5t-6s=1$
$(0,1)$   $t=-1$   $s=-1$
$x=-5$ в $\mathbb{Z}_{30}$ это $x=\bar{25}=e_{1}$

Проверим: $25^{2}=625=\underbrace{ 600 }_{ 30\cdot20 }+25$

Второй это
$\bar{1}-\bar{25}=\bar{6}=e_{2}$
$6^{2}=36=30+6$

>[!note] [[Идемпотентный элемент|Идемпотентные элементы]] в сумме дают единицу

Пусть $e - \text{Идемпотентный элемент}$
$e^{2}=e$
$(1-e)^{2}=1^{2}+2\cdot1\cdot e+e^{2}=1-2e+e=1-e$

$f:\mathbb{Z}_{30}\to \mathbb{Z}_{5}\times \mathbb{Z}_{6}$
$f(1,3)=(\bar{3}, \bar{1})$
$f^{-1}(\bar{3}, \bar{1})=3\bar{e}_{1}+\bar{1}\cdot   \bar{e}_{2}=\cancel{ 3\cdot 25 + 1\cdot 6 }$ - частая ошибка (перепутать идемпотентные элементы), -$3\cdot 6 + 1 \cdot 25 = 18+25=43=30+13$


>[!note] буквой $e$ любят обозначать [[Идемпотентный элемент]]

Ответ на вопрос темы:
Надо найти два основных идемотента $\bar{e}_{1}$, $\bar{e}_{2}$
$f(e_{1})=(1,0)$
$f(e_{2})=(0,1)$

$f^{-1}(a,b)=a\cdot  \bar{e}_{1}+b\cdot  \bar{e}_{2}$

### Еще один пример для кольца $\mathbb{Z}_{30}$
$f:\mathbb{Z}_{30}\to \mathbb{Z}_{5}\times \mathbb{Z}_{6}$

$f^{-1}(2,3)=2\cdot  \bar{e}_{1} + 3 \cdot  \bar{e}_{2}=2\cdot  \bar{6}+3\cdot  \bar{25}=12+75=87 \text{ mod (30)}$
ответ $\bar{27}$
Это сильная форма [[Китайская теорема об остатках]]
позволяет вычислить прообраз после вычислений основных идемпотентов

## Группа обратимых элементов кольца $\mathbb{Z}_{n}$
$\mathbb{Z}_{n}^{*}=\{ \bar{x} \in \mathbb{Z}_{n} ~ ~ \exists   \bar{y} \in \mathbb{Z}_{n}; ~ ~ \bar{x}\cdot  \bar{y}= \bar{1} \}=\{ \bar{x} \in \mathbb{Z}_{n}~ ~ (x,n)=1 \}$
$|\mathbb{Z}_{n}^{*}|=\phi(n)$ - [[Функция Эйлера]]
$I:$ $\bar{a}\in\mathbb{Z}_{n}^{*}$       $\bar{a}^{\phi(n)}=\bar{1} \iff \text{ord} (\bar{a}) ~|~ \phi(n)$

### Как вычисляется $\phi(n)$ ?
$\phi(p)=p-1$ если p - простое
$\phi(p^{k})=p^{k}-p^{k-1}$
Th. Мультипликативности: Если $(m,n)=1$, то $\phi(mn)=\phi(m)\cdot \phi(n)$

#### Докажем

Давайте говорить о кольцах

$A - \text{кольцо}$  $A^{*}=\{ a \in A  ~ ~ \exists ~ b\in A ~ a\cdot x=1\}$
$(A\times B)^{*}$ (какие пары будут обратимыми?)
$=\{ (a_{1},a_{2}) \in A \times B, \text{что } \exists~ (x,y) \text{, что } (a,b)(x,y)=(1,1) \}$ $\iff$
$a\in A \iff a\cdot x =1$
$b\in B ^{*} \iff b \cdot y = 1$
#### Итог:
$(A\times B)^{*}=\{ ((c_{1},c_{2}) ~ a\in A^{*}; b\in B^{*} = A^{*}\times B^{*} \}$

$\mathbb{Z}_{mn} \cong \mathbb{Z}_{m}\times \mathbb{Z}_{n}$ - по операциям также изоморфны 
$(\mathbb{Z}_{mn})^{*}\cong(\mathbb{Z}_{m}\times \mathbb{Z}_{n})^{*}=\mathbb{Z}^{*}_{m}\times \mathbb{Z}_{n}^{*}$ $\leftarrow$ здесь $\phi(m)\cdot \phi(n)$ элементов
$\implies \phi(mn)=\phi(m)\cdot \phi(n)$
## Решение уравнений в кольцах вычетов

$x^{2}=1$   $x_{1,2}=\pm1$
$\text{в } \mathbb{Z}_{4}$
$\bar{x}_{1}=\bar{1}$
$\bar{x}_{2}=\bar{n-1}$
Напоминаем, что теорема Безу здесь не работает
чтобы она работало колько должно быть [[Поле|полем]]

[[Поле]] это колько (к.а.с 1) в котором все элементы $\neq 0$ обратимы
$\mathbb{Z}_{n}-\text{поле} \iff n=p - \text{простое число}$


в $\mathbb{Z}_{30}$ есть еще решения
$\mathbb{Z}_{30} \cong \mathbb{Z}_{5} \times \mathbb{Z}_{6}$
$f\hat{\mathbf{x}} \to (a,b)$
$x^{2}=1$
$(\bar{a},\bar{b})^{2}=(\bar{1},\bar{1})$
$\bar{a}^{2}=1$ в $\mathbb{Z}_{5}$
$\bar{b}^{2}=\bar{1}$ в $\mathbb{Z}_{6}$


$\bar{a}\equiv1 \text{ mod 5}$
или
$\bar{a}\equiv4 \text{ mod 5}$
$\bar{b}^{2}=\bar{1}$ в $\mathbb{Z}_{6}$
$\bar{b}\equiv 1 \text{ mod 6}$
$\bar{b}\equiv 5 \text{ mod 6}$
$\implies$ есть 4 решения
$f^{-1}(4,1)=4 \cdot 6 + 1 \cdot 25 =49=\bar{19}$

итого
$\bar{1} \text{ и  } \bar{29}=-\bar{1}$
$\bar{19} \text{ и } \bar{11}$

>[!note] В билетах есть вопрос как перечислять решения этого уравнения
Звучит так: "Как искать в $\mathbb{Z}_{n}$ элементы порядка 2"
т.е. решения уравнения $\bar{x}^{2}=\bar{1}$
$n=p_{1}^{k_{1}}\cdot p_{2}^{k_{2}}\dots p_{kn}^{kn}$  $p_{i}$ - различные протсые

$\mathbb{Z}_{n} \cong \mathbb{Z}_{p_{1}k_{1}}\times \mathbb{Z}_{p_{2}k_{2}}\times\dots \times \mathbb{Z}_{pnkn}$
$x=(x_{1}, \dots, x_{n})$    $x_{i}=x \text{ mod } p_{i}^{k_{i}}$
$x_{0}^{2}=1$

### Как решить $x^{2}=1$ в $\mathbb{Z}_{p^{k}}$ ?
$x^{2}=1+ep^{k}$
$x^{2}-1=e\cdot p^{k}$
$(x-1)(x+1)=e\cdot p^{k}$
при $p>2$ только один сомножитель делится на $p^{k}$ $\implies$
либо $x-1=e'\cdot p^{k}$ $\bar{x}=\bar{1}$
либо $x+1=e^{k}\cdot p^{k}$  $\bar{x}=-\bar{1}$

### Что, если p=2
$(x-1)(x+1)=2^{k}\cdot s$
$(x-1)(x+1)\vdots 2^{k}$
либо один из сомножителей $\vdots 2^{k}$ $\implies$ $x=\pm1$
либо один из сомножителей $\vdots2$, другой $\vdots 2^{k-1}$
на 4 уже оба сомножителя не делятся
$x-1 \vdots 2^{k-1}$ $\implies x=1+2^{k-1}$

проверим
$$
(2^{k-1}+1)^{2}=2^{2k-2}+2\cdot 2 ^{k-1} \cdot 1 + 1 = 2^{k}\cdot 2^{k-2} + 2^{k} + 1
$$
Итог:
$x^{2}=1$ 
в $\mathbb{Z}_{2^{k}}$  $k>2$
имеет 4 корня
$x_{1,2}=\pm 1$
$x_{3,4}= 2^{k-1} \pm 1$
$7^{2}\equiv 1 \text{ mod 16}$
$9^{2}\equiv 1 \text{ mod }$

## Grand финал

$x \in \mathbb{Z}_{n}^{*}$
$\text{ord x} ~|~ \phi(n)$

$\mathbb{Z}_{n}^{*}=(\mathbb{Z}_{p_{1}^{k_{1}}})^{*}x \dots x(\mathbb{Z}_{p_{s}^{k_{s}}})^{*}$
$x=(x_{1}, \dots, x_{s})$
$x^{2}=(x_{1}^{e}, \dots, x_{s}^{e})$
$\text{ord x} = \text{ НОК } (\text{ord }x_{1}, \dots, \text{ord }x_{s})$
$\text{ord }x_{i} ~|~ \phi(p_{i}^{k_{i}})=(p_{i}^{k_{i}}-p_{i}^{k_{i}-1})$

Итог: 
$\text{ord}$ x | НОК($p_{1}^{k_{1}}-p_{1}^{k_{1}-1}; \dots;p_{s}^{k_{s}}-p_{s}^{k_{s}-1}$)

