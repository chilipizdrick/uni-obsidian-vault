---
aliases: 
tags:
  - practice
  - seminar
  - 2nd-semester
---

> Creation time: 10:45

# [[2024-03-25 Practice - Линал]]

> RECAP

# Сюжет похожий, но несколько другой

>[!ABSTRACT]
>Комплексные числа - одна из причин невозможности диагонализации
>Рассмотрим второй возможный проблемный случай случай


## Пример

$$
\begin{gather}
\begin{pmatrix}
1 & -1 & 2 \\
0 & 2 & 3 \\
0 & 0 & 2
\end{pmatrix}
\end{gather}
$$

>[!ABSTRACT]
>Ультимативная цель - облегчение возведения в степень

Попробуем диагонализировать:

$$
\begin{gather}
\begin{vmatrix}
1-\lambda & -1 & 2 \\
0 & 2-\lambda & 3 \\
0 & 0 & 2-\lambda
\end{vmatrix}=(1-\lambda)\underbrace{ (2-\lambda)^{2} }_{ \text{ потенциальная проблема }  }=0 \\
\begin{cases}
\lambda_{1}=1 \\
\lambda_{2,3}=2
\end{cases}
\end{gather}
$$


>[!WARNING]
>Повторяющееся собственные значения

$$
\begin{gather}
\lambda_{1}=1 \\
\begin{pmatrix}
0 & -1 & 2 \\
0 & 1 & 3 \\
0 & 0 & 1
\end{pmatrix} \cdot \begin{pmatrix}
x_{1} \\
x_{2} \\
x_{3}
\end{pmatrix}=\begin{pmatrix}
0 \\
0 \\
0
\end{pmatrix} \\
\begin{cases}
x_{3}=0 \\
x_{2}+3x_{3}=0 \\
x_{2}=0
\end{cases} \\
\vec{x_{1}}=\begin{pmatrix}
1 \\
0 \\
0
\end{pmatrix}-\text{ самый простой вариант } 
\end{gather}
$$

$$
\begin{gather}
\begin{pmatrix}
-1 & -1 & 2 \\
0 & 0 & 3 \\
0 & 0 & 0
\end{pmatrix} \cdot \begin{pmatrix}
x_{1} \\
x_{2} \\
x_{3}
\end{pmatrix}=\begin{pmatrix}
0 \\
0 \\
0
\end{pmatrix} \\
\begin{cases}
x_{3}=0 \\
-x_{1}-x_{2}+2x_{3}=0 \\
-x_{1}-x_{2}=0
\end{cases} \\
\vec{x_{2}}=\begin{pmatrix}
1 \\
-1 \\
0
\end{pmatrix}
\end{gather}
$$

$$
\begin{gather}
\begin{pmatrix}
A=\underbrace{ S }_{ \text{ собственный базис }  } \cdot \underbrace{ \Lambda }_{ \text{ диаг. матрица }  }  \cdot S^{-1}
\end{pmatrix}
\end{gather}
$$

>[!WARNING]
>Мы не можем взять 3 л.н.з. собсвтенных вектора, $S^{-1}$ не существует
>Диагонализировать эту матрицу нельзя

>[!ABSTRACT]
>Решение похоже на прошлый случай, попробуем смягчить требования.
>Мы не можем найти диагональную матрицу, но может быть мы можем найти "почти" диагональную матрицу, которая нас возможно устроит
>И так сделать действительно можно

## Фокус

$$
\begin{gather}
\text{ Before: } \  (A-\lambda I) \cdot  \vec{x_{2}}= \vec{0} \\
\text{ Now: } \ (A-\lambda I) \cdot  \underline{\vec{y}}  = \vec{x_{2}} \\
\underline{\vec{y}}-\text{ Обобщенный собственный вектор } 
\end{gather}
$$

>[!ABSTRACT] Зачем и что это
>Зачем искать прошлый собственный вектор?
>Если раскрыть скобки и перенести
>$A\vec{y}-\lambda I\vec{y}= \vec{x_{2}}$
>$A\vec{y}= \vec{x_{2}}+\lambda \vec{y}$
>Если матрицу A умножить на лин. комб. $A(\alpha \vec{x} + \beta \vec{y})=\alpha A \vec{x}+\beta A   \vec{y}=$
>$=\alpha \lambda \vec{x} + \beta(\vec{x} + \lambda \vec{y})=$
>$=(\alpha \lambda+\beta)\vec{x}+\beta \lambda \vec{y}$
>Были вектора $\vec{x}, \vec{y}$
>Они лежали в двумерном подпространстве
>Если применить оператор к любой линейной комбинации, то результат останется на той же плоскости.
>Значит собственный вектор $\vec{x}_{2}$ и обобщенный собсветнный вектор (как собственный, но не совсем) $\vec{y}$


### В нашем примере

$$
\begin{gather}
\begin{pmatrix}
-1 & -1 & 2 \\
0 & 0 & 3 \\
0 & 0 & 0
\end{pmatrix} \cdot \begin{pmatrix}
y_{1} \\
y_{2} \\
y_{3}
\end{pmatrix}=\begin{pmatrix}
1 \\
-1 \\
0
\end{pmatrix} \\
\begin{cases}
3y_{3}=1 \\
y_{2} = -\frac{1}{3}  \\
-y_{1}-y_{2}+2y_{3}=1
\end{cases} \\
\begin{cases}
y_{1}=0 \\
y_{2}=-\frac{5}{3}  \\
y_{3}=-\frac{1}{3}
\end{cases} \\
\vec{y}=\begin{pmatrix}
0 \\
-\frac{5}{3} \\
-\frac{1}{3}
\end{pmatrix}
\end{gather}
$$

$$
\begin{gather}
P=\begin{pmatrix}
1 & 1 & 0 \\
0 & -1 & -\frac{5}{3} \\
0 & 0 & -\frac{1}{3}
\end{pmatrix}=(\vec{x}_{1}|\vec{x}_{2}|\vec{y}) \\
A=PJP^{-1} \\
AP=PJ \\
A(\vec{x}_{1}|\vec{x}_{2}|\vec{y}) =(\vec{x}_{1}|\vec{x}_{2}|\vec{y})J \\
(\underbrace{ A\vec{x}_{1} }_{ 1x_{1}\vec{} }|\underbrace{ A\vec{x}_{2} }_{ 2\vec{x}_{2} }|\underbrace{ A\vec{y} }_{ x_{2}+2y })=(\vec{x}_{1}|\vec{x}_{2}|\vec{y})\underbrace{ \begin{pmatrix}
1 & 0 & 0 \\
0 & \underbrace{ 2 }_{ \lambda=2 } & 1 \\
0 & 0 & 2
\end{pmatrix} }_{ J } \\
\end{gather}
$$

>[!ABSTRACT] Жорданова нормальна форма
>матрица J - в Жордановой нормальной форме
>Это способ диагонализировать если не хватает собсвтенных вектор

$$
\begin{gather}
\underset{ 7\times 7 }{ A } \\
\mathcal{X}(\lambda)=\underbrace{ (\lambda-\lambda_{1}) }_{ \vec{x}_{1} }\underbrace{ (\lambda-\lambda_{2}) }_{ \vec{x}_{2} }\underbrace{ (\lambda-\lambda_{3})^{3} }_{ \vec{x}_{3} }\underbrace{ (\lambda-\lambda_{4})^{2} }_{ \vec{x}_{4} } \\ \\
J=\begin{pmatrix}
\lambda_{1} & &  &  & 0  & \\
 &  & \lambda_{2} &  &  &  &  \\
 &  &  &  \lambda_{3}  & 1 &  &  \\
 &0  &  & &  \lambda_{3} & 1 &  &  \\
 &  &  &  &   & \lambda_{3} &  &  \\
\dots
\end{pmatrix}
\end{gather}
$$

Состоит из Жордановых блоков

>[!ABSTRACT] Геометрическая функция
>сколько л.н.з. векторов можно выцепить из $\lambda$ - геометрическая кратность
>**EXAMPLE**: $\underbrace{ (\lambda-\lambda_{3})^ {3- \text{ алгебраическая кратность }}  }_{  \vec{x}_{3} - \text{ геометрическая кратность } }$

$$
\begin{gather}
\begin{pmatrix}
2 & 2 & 1 \\
0 & 3 & -2 \\
0 & 0 & 3
\end{pmatrix} \\
\begin{vmatrix}
2-\lambda & 2 & 1 \\
0 & 3-\lambda & -2 \\
0 & 0 & 3-\lambda
\end{vmatrix}=0 \\ \\
(2-\lambda)(3-\lambda)^{2}+0+0=0 \\
\lambda_{1}=2; \lambda_{2,3}=3 \\
\end{gather}
$$

$$
\begin{gather}
\lambda_{1}=2 \\
\begin{pmatrix}
0 & 2 & 1 \\
0 & 1 & -2 \\
0 & 0 & 1
\end{pmatrix}\begin{pmatrix}
x_{1} \\
x_{2} \\
x_{3}
\end{pmatrix}=\begin{pmatrix}
0 \\
0 \\
0
\end{pmatrix} \\
\begin{cases}
2x_{2}+\vec{x}_{3}=0 \\
\vec{x}_{2}-2\vec{x}_{3}=0 \\
\vec{x}_{3}=0
\end{cases} \\
\vec{x}_{2}-0; \ \vec{x}_{2}=0 \\
\begin{pmatrix}
1 \\
0 \\
0
\end{pmatrix}
\end{gather}
$$

$$
\begin{gather}
\lambda_{3}=3 \\
\begin{pmatrix}
-1 & 2 & 1  \\
0 & 0 & -2 \\
0 & 0 & 0
\end{pmatrix}\begin{pmatrix}
x_{1} \\
x_{2} \\
x_{3}
\end{pmatrix}= \vec{0} \\
\begin{cases}
-x_{1}+2x_{2}+x_{3}=0 \\
-2x_{3}=0 ;x_{3}=0
\end{cases} \\
2x_{2}=x_{1} \\
\begin{pmatrix}
2 \\
1 \\
0
\end{pmatrix} \\
\end{gather}
$$

$$
\begin{gather}
\begin{pmatrix}
-1 & 2 & 1 \\
0 & 0 & -2 \\
0 & 0 & 0
\end{pmatrix}\begin{pmatrix}
y_{1} \\
y_{2} \\
y_{3}
\end{pmatrix}=\begin{pmatrix}
2 \\
1 \\
0
\end{pmatrix} \\
\begin{cases}
-y_{1}+2y_{2}+y_{3}=2 \\
-2y_{3}=1; y_{3}=-\frac{1}{2} \\

\end{cases} \\
\begin{pmatrix}
-\frac{5}{2} \\
0 \\
-\frac{1}{2}
\end{pmatrix} \\

J=\begin{pmatrix}
2 & 0 & 0 \\
0 & 3 & 1 \\
0 & 0 & 3
\end{pmatrix} \\
P=\begin{pmatrix}
1 & 2 & -\frac{5}{2} \\
0 &  1 & 0 \\
0 & 0 & -\frac{1}{2}
\end{pmatrix}
\end{gather}
$$

## Еще пример

$$
\begin{gather}
A= \begin{pmatrix}
3 & -1 & -1 \\
2 & 0 & -1 \\
1 & 0 & 0
\end{pmatrix} \\
\mathcal{X}_{A}(\lambda)=-\lambda^{3}+\text{ trA }\lambda^{2}-\sum_{i=1}^{3}M_{ij}\lambda+\det(A) \\
\mathcal{X}_{A}(\lambda)=-\lambda^{3}+3\lambda^{2}-(0+1+2) \cdot \lambda \\ 
\sum_{i=1}^{3} M_{ij}=\begin{vmatrix}
0 & -1 \\
0 & 0
\end{vmatrix}+\begin{vmatrix}
3 & -1 \\
1 & 0
\end{vmatrix}+\begin{vmatrix}
3 & -1 \\
2 & 0
\end{vmatrix}=0+1+2=3 \\
\mathcal{X}_{A}(\lambda)=-\lambda^{3}+3\lambda^{2}-3\lambda+1=0 \\
(\lambda-1)^{3} \\
\lambda_{1,2,3}=1:
\end{gather}
$$
$$
\begin{gather}
\begin{pmatrix}
2 & -1 & -1 \\
2 & -1 & -1 \\
1 & 0 & -1
\end{pmatrix} \cdot \begin{pmatrix}
x_{1} \\
x_{2} \\
x_{3}
\end{pmatrix}=\begin{pmatrix}
0 \\
0 \\
0
\end{pmatrix} \\
\begin{cases}
2x_{1}-x_{2}-x_{3}=0 \\
x_{1}-x_{3}=0
\end{cases}\implies
\begin{cases}
x_{1}=x_{3} \\
x_{1}-x_{2}=0 \\
x_{1}=x_{2}
\end{cases}\implies \\
\implies \begin{pmatrix}
x_{1} \\
x_{2} \\
x_{3}
\end{pmatrix}=\begin{pmatrix}
1 \\
1 \\
1
\end{pmatrix} \\
\begin{pmatrix}
2 & -1 & -1 \\
2 & -1 & -1 \\
1 & 0 & -1
\end{pmatrix} \cdot \begin{pmatrix}
y_{1} \\
y_{2} \\
y_{3}
\end{pmatrix}=\begin{pmatrix}
1 \\
1 \\
1
\end{pmatrix}
\\
\begin{cases}
2y_{1}-y_{2}-y_{3}=1 \\
y_{1}-y_{3}=1
\end{cases} \\
\begin{cases}
y_{3}=0 \\
y_{2}=1 \\
y_{1}=1
\end{cases} \\
\vec{y}=\begin{pmatrix}
1 \\
1 \\
0
\end{pmatrix}
\end{gather}
$$

$$
\begin{gather}
\begin{pmatrix}
2 & -1 & -1 \\
2 & -1 & -1 \\
1 & 0 & -1
\end{pmatrix} \cdot  \begin{pmatrix}
y_{1} \\
y_{2} \\
y_{3}
\end{pmatrix}=\begin{pmatrix}
1 \\
1 \\
0
\end{pmatrix} \\
\begin{cases}
2z_{1}-z_{2}-z_{3}=1 \\
z_{1}-z_{3}=0
\end{cases} \\

\left.\begin{array}{\ll}
z_{1}=z_{3}=0 \\
z_{2}=-1
\end{array} \right\} \implies \vec{z}=\begin{pmatrix}
0 \\
-1 \\
0
\end{pmatrix} \\
P=\begin{pmatrix}
1 & 1 & 0 \\
1 & 1 & 1 \\
1 & 0 & 0
\end{pmatrix} \\
J = \begin{pmatrix}
1 & 1 & 0 \\
0 & 1 & 1 \\
0 & 0 & 1
\end{pmatrix}

\end{gather}
$$

>[!ABSTRACT] В чем вообще идея
>Альтернативным взглядом можно считать следующее:
>у нас есть $\lambda$, ее геометрическая кратность меньше алгебраической
>$(A-\lambda I)\vec{x}_{1}=0$ - первый собсвтенный вектор ищем так, $x_{1}$ является решением и принадлежит ядру $(A-\lambda I)$ $\vec{x}_{1}  \in \text{ Ker }(A-\lambda I)$
>$(A-\lambda I)\vec{x}_{2}=\vec{x}_{1}$ -> $(A-\lambda I)^{2}\vec{x}_{2}=(A-\lambda I)\vec{x}_{1}\implies \vec{x}_{2}  \in \text{ Ker }(A-\lambda I)^{2}$
>$(A-\lambda I)\vec{x}_{3}=\vec{x}_{2}$, $\vec{x}_{3}  \in \text{ Ker }(A-\lambda I)^{3}$
>...
>$(A-\lambda I)\vec{x}_{n}=\vec{x}_{n-1}$, $\underbrace{ \vec{x}_{n} }_{ \text{ обобщенный собственный вектор } }  \in \underbrace{ \text{ Ker }(A-\lambda I)^{n} }_{ \text{ корневое подпространство } }$
>так можно делать пока позволяет алгебраическая кратность

>[!ABSTRACT] В обратном направлении
>Цепочка выше - Жоданова цепочка
>$\vec{x}_{n}  \cancel{ \in } \text{ Ker }(A-\lambda I)^{n-1}$ - генератор

$$
\begin{gather}

(A-\lambda I)=\begin{pmatrix}
2 & -1 & -1 \\
2 & -1 & -1 \\
1 & 0 & -1
\end{pmatrix}\begin{pmatrix}
1 \\
0 \\
0
\end{pmatrix} = \begin{pmatrix}
2 \\
2 \\
1
\end{pmatrix} \\
\begin{pmatrix}
2 &  -1 & -1 \\
2 & -1 & -1 \\
1 & 0 & -1
\end{pmatrix}\begin{pmatrix}
2 \\
2 \\
1
\end{pmatrix}=\begin{pmatrix}
1 \\
1 \\
1
\end{pmatrix} \\
\begin{pmatrix}
2 & -1 & -1 \\
2 & -1 & -1 \\
1 & 0 & -1
\end{pmatrix}\begin{pmatrix}
1 \\
1 \\
1
\end{pmatrix}=\begin{pmatrix}
0 \\
0 \\
0
\end{pmatrix} \\
J=\begin{pmatrix}
1 & 1 & 0 \\
0 & 1 & 1 \\
0 & 0 & 1
\end{pmatrix} \\
P=\begin{pmatrix}
1 & 2 & 1 \\
1 & 2 & 0 \\
1 & 1 & 0
\end{pmatrix}
\end{gather}
$$
